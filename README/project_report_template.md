# 차량 내부 네트워크 침입 탐지를 위한 HyDL-IDS 모델 개발 및 분석

## I. 서론

### 프로젝트 목표
본 프로젝트의 목표는 차량 내부 네트워크(CAN 버스) 침입 탐지를 위한 하이브리드 딥러닝 기반 침입 탐지 시스템(HyDL-IDS)을 개발하고 분석하는 것입니다. 이를 통해 차량 내 네트워크에서 발생할 수 있는 다양한 유형의 사이버 공격을 효과적으로 탐지하고자 합니다.

### 자동차 보안에서 IDS의 중요성
현대 자동차는 수십 개의 전자 제어 장치(ECU)가 CAN(Controller Area Network) 버스를 통해 통신하는 복잡한 네트워크 시스템을 갖추고 있습니다. 자율주행 기술과 커넥티드 카 기능이 발전함에 따라 차량의 디지털화 수준이 급증하였으며, 이는 차량이 사이버 공격에 노출될 가능성을 크게 증가시켰습니다.

차량 해킹은 단순한 데이터 유출을 넘어 운전자와 승객의 안전에 직접적인 위협이 될 수 있습니다. 공격자가 브레이크, 엔진, 조향 시스템과 같은 중요 구성 요소를 제어할 수 있게 되면 심각한 안전 사고를 유발할 수 있습니다. 실제로 연구자들은 원격으로 차량의 제어 시스템을 해킹하여 브레이크를 비활성화하거나 엔진을 정지시키는 등의 시연을 통해 이러한 위험성을 증명한 바 있습니다.

따라서 차량 내부 네트워크에 침입 탐지 시스템(IDS)을 구축하는 것은 사이버 보안과 차량 안전을 위한 필수적인 요소가 되었습니다. 효과적인 IDS는 비정상적인 네트워크 트래픽을 실시간으로 감지하고 대응함으로써 공격이 중요 시스템에 영향을 미치기 전에 차단할 수 있습니다.

### HyDL-IDS 모델의 핵심 아이디어
HyDL-IDS(Hybrid Deep Learning-based Intrusion Detection System)는 CAN 트래픽의 공간적 특징과 시간적 특징을 동시에 추출하여 향상된 침입 탐지 성능을 제공하기 위해 설계되었습니다. 이 모델의 핵심 아이디어는 다음과 같습니다:

1. **컨볼루션 신경망(CNN)과 장단기 메모리(LSTM) 네트워크의 결합**:
   - CNN 컴포넌트는 CAN 메시지 내의 데이터 바이트 간의 공간적 관계를 포착합니다.
   - LSTM 컴포넌트는 연속적인 CAN 메시지 시퀀스에서 시간적 패턴을 학습합니다.
   - 이러한 하이브리드 접근 방식은 단일 메시지뿐만 아니라 메시지 시퀀스의 패턴까지 고려하여 보다 정확한 탐지가 가능하게 합니다.

2. **다양한 공격 유형 탐지 능력**:
   - DoS(Denial of Service) 공격: CAN 버스를 과부하시키는 공격
   - Fuzzy 공격: 무작위 데이터로 시스템을 혼란시키는 공격
   - 스푸핑 공격: 기어 조작(Spoofing Gear) 및 RPM 조작(Spoofing RPM)과 같은 특정 ECU를 대상으로 한 공격

3. **실시간 탐지를 위한 효율적인 처리**:
   - 시퀀스 기반 접근 방식을 통해 필요한 메모리와 계산 리소스를 최적화하여 차량 내 제한된 컴퓨팅 환경에서도 실행 가능합니다.

4. **높은 정확도와 낮은 오탐지율**:
   - 하이브리드 아키텍처는 단일 방법론에 비해 더 높은 정확도와 낮은 오탐지율을 달성합니다.
   - 이는 차량 안전에 영향을 미치지 않으면서 실제 공격을 효과적으로 탐지하기 위해 매우 중요합니다.

본 보고서는 HyDL-IDS 모델의 설계, 구현, 평가 및 분석에 대한 상세 내용을 다룰 것입니다. Car-Hacking 데이터셋(HCRL, 고려대학교)을 활용한 실험 결과를 통해 모델의 성능과 효과를 검증하고, 차량 내부 네트워크 보안을 위한 침입 탐지 시스템으로서의 가능성을 평가할 것입니다.

## II. HyDL-IDS 모델 아키텍처

HyDL-IDS 모델은 CAN 데이터 스트림에서 공간적 특징과 시간적 특징을 함께 추출할 수 있는 하이브리드 딥러닝 아키텍처를 채택했습니다. 이 섹션에서는 모델의 각 구성 요소와 전체 아키텍처에 대해 상세히 설명합니다.

### 아키텍처 개요
HyDL-IDS 모델은 크게 다음과 같은 주요 컴포넌트로 구성됩니다:
1. 입력층
2. 특징 추출 부분 (CNN 기반)
   - Convo Unit I
   - Convo Unit II
3. 시계열 패턴 학습 부분 (LSTM 기반)
4. 분류 부분 (Dense 레이어)

![HyDL-IDS 모델 아키텍처 다이어그램]

### 각 구성 요소 상세 설명

#### 1. 입력층
- **형태**: (시퀀스 길이, 특성 수)
- **시퀀스 길이**: 윈도우 크기로 설정 (기본값: 10)
- **특성 수**: 전처리된 CAN 메시지 필드의 수 (CAN ID, DLC, DATA[0]-DATA[7])로 구성
- **입력 데이터 형식**: 3차원 텐서 [배치 크기, 시퀀스 길이, 특성 수]

입력층에서는 시간에 따른 일련의 CAN 메시지를 받아들입니다. 각 메시지는 CAN ID, DLC, 데이터 바이트 등의 정보가 포함된 특성 벡터로 표현됩니다. 윈도우 방식으로 연속된 메시지들을 그룹화하여 시계열 데이터로 처리합니다.

#### 2. Convo Unit I
- **Conv1D 레이어**:
  - 필터 수: 32
  - 커널 크기: 3
  - 활성화 함수: ReLU
  - 입력 데이터 형식: 'channels_last'
- **배치 정규화**:
  - 학습 시 안정성 향상을 위한 정규화 적용
- **최대 풀링**:
  - 풀 크기: 2
  - 패딩: 'valid'
- **드롭아웃**:
  - 비율: 0.2 (과적합 방지)

Convo Unit I은 1D 컨볼루션을 통해 CAN 메시지 내 특성들 간의 공간적 관계를 포착합니다. 32개의 필터를 사용하여 다양한 특징 패턴을 학습하고, 배치 정규화를 통해 학습 안정성을 높입니다. 최대 풀링은 데이터 차원을 줄이고 계산 효율성을 높이며, 드롭아웃은 과적합을 방지합니다.

#### 3. Convo Unit II
- **Conv1D 레이어**:
  - 필터 수: 64
  - 커널 크기: 3
  - 활성화 함수: ReLU
  - 입력 데이터 형식: 'channels_last'
- **배치 정규화**:
  - 학습 시 안정성 향상을 위한 정규화 적용
- **최대 풀링**:
  - 풀 크기: 2
  - 패딩: 'valid'
- **드롭아웃**:
  - 비율: 0.2 (과적합 방지)

Convo Unit II는 Convo Unit I의 출력을 더 깊은 수준에서 처리합니다. 필터 수를 64개로 늘려 더 복잡한 패턴을 학습할 수 있게 합니다. 이 단계에서 더 추상적이고 고차원적인 특징을 추출합니다.

#### 4. LSTM 레이어
- **유닛 수**: 128
- **활성화 함수**: tanh
- **상태 유지**: 시계열 데이터의 문맥 정보 보존

LSTM 레이어는 CNN을 통해 추출된 특징들의 시간적 관계를 학습합니다. CAN 메시지의 시퀀스에서 시간에 따른 패턴 변화를 포착하여, 단일 메시지 분석만으로는 탐지하기 어려운 시간적 이상 징후를 감지할 수 있게 합니다.

#### 5. Flatten 레이어
LSTM의 출력을 1차원 벡터로 변환하여 Dense 레이어의 입력으로 사용할 수 있게 합니다.

#### 6. Dense 레이어 1
- **유닛 수**: 128
- **활성화 함수**: 기본 선형 활성화

이 레이어는 추출된 특징들을 종합적으로 처리하여 높은 수준의 추상화를 제공합니다.

#### 7. Dropout 레이어
- **비율**: 0.2

훈련 중에 네트워크의 일부 뉴런을 무작위로 비활성화하여 과적합을 방지합니다.

#### 8. 출력 레이어 (Dense 레이어 2)
- **유닛 수**: 1
- **활성화 함수**: sigmoid

시그모이드 활성화 함수를 통해 0과 1 사이의 값을 출력, 이는 입력 CAN 메시지 시퀀스가 공격(1에 가까운 값)인지 정상(0에 가까운 값)인지를 나타냅니다.

### 모델 아키텍처 요약 표

| 레이어 | 출력 형태 | 파라미터 수 | 활성화 함수 |
|--------|-----------|------------|------------|
| 입력층 | (None, 10, 10) | 0 | - |
| Conv1D_1 | (None, 8, 32) | 992 | ReLU |
| BatchNormalization_1 | (None, 8, 32) | 128 | - |
| MaxPooling1D_1 | (None, 4, 32) | 0 | - |
| Dropout_1 | (None, 4, 32) | 0 | - |
| Conv1D_2 | (None, 2, 64) | 6,208 | ReLU |
| BatchNormalization_2 | (None, 2, 64) | 256 | - |
| MaxPooling1D_2 | (None, 1, 64) | 0 | - |
| Dropout_2 | (None, 1, 64) | 0 | - |
| LSTM | (None, 128) | 98,816 | tanh |
| Flatten | (None, 128) | 0 | - |
| Dense_1 | (None, 128) | 16,512 | 선형 |
| Dropout_3 | (None, 128) | 0 | - |
| 출력(Dense_2) | (None, 1) | 129 | sigmoid |

**총 파라미터 수**: 123,041  
**학습 가능 파라미터 수**: 122,849  
**학습 불가능 파라미터 수**: 192

### 아키텍처 설계의 이점

1. **공간적, 시간적 특징 동시 추출**:
   - CNN을 통한 공간적 특징 추출과 LSTM을 통한 시간적 특징 추출의 결합으로 더 포괄적인 패턴 인식이 가능합니다.

2. **계층적 특징 추출**:
   - 두 개의 Convo Unit이 순차적으로 배치되어 점진적으로 더 복잡한 특징을 추출할 수 있습니다.

3. **과적합 방지 메커니즘**:
   - 배치 정규화, 드롭아웃 레이어를 통해 과적합을 효과적으로 방지하고 일반화 성능을 향상시킵니다.

4. **효율적인 파라미터 사용**:
   - 총 12만여 개의 학습 가능 파라미터로 충분한 표현력을 확보하면서도 연산 효율성을 유지합니다.

5. **적응성과 확장성**:
   - 다양한 유형의 CAN 트래픽 데이터에 적용 가능하며, 필요에 따라 하이퍼파라미터 조정을 통해 모델을 확장할 수 있습니다.

이러한 하이브리드 아키텍처를 통해 HyDL-IDS는 CAN 버스 트래픽에서 발생하는 다양한 유형의 사이버 공격을 효과적으로 탐지할 수 있는 강력한 기반을 갖추고 있습니다.

## III. 실험 환경

### 데이터셋

본 연구에서는 고려대학교 HCRL(Hacking and Countermeasure Research Lab)에서 제공하는 Car-Hacking 데이터셋을 사용하였습니다. 이 데이터셋은 실제 차량 환경에서 수집된 CAN 버스 트래픽 데이터로, 정상 상태의 트래픽과 다양한 유형의 공격이 수행된 트래픽을 포함하고 있습니다.

#### 데이터셋 특징

- **데이터 구조**: 
  - Timestamp (float, 초): 메시지 수신 시간
  - CAN ID (16진수 문자열): 메시지 식별자
  - DLC (int, 0-8): 데이터 길이 코드
  - DATA[0]-DATA[7] (각 바이트에 대한 16진수 문자열): 데이터 바이트
  - Flag/Tag (문자열): 'R'(정상) 또는 'T'(공격)

- **공격 유형**:
  1. **DoS (Denial of Service) 공격**: 
     - 대량의 메시지를 지속적으로 전송하여 네트워크를 과부하시키는 공격
     - 특성: 높은 메시지 빈도, 동일한 CAN ID의 반복
  
  2. **Fuzzy 공격**: 
     - 무작위 데이터 값을 전송하여 ECU의 오작동을 유발하는 공격
     - 특성: 정상 범위를 벗어난 데이터 값, 불규칙한 패턴
  
  3. **Spoofing Gear 공격**: 
     - 기어 관련 ECU에 거짓 메시지를 주입하여 변속기 동작을 조작하는 공격
     - 특성: 기어 관련 CAN ID에 대한 비정상적인 데이터 값
  
  4. **Spoofing RPM 공격**: 
     - RPM 관련 ECU에 거짓 메시지를 주입하여 엔진 RPM 표시를 조작하는 공격
     - 특성: RPM 관련 CAN ID에 대한 비정상적인 데이터 값

- **데이터셋 규모**:
  - 총 샘플 수: [사용자 실행 결과 필요]
  - 정상 샘플 수: [사용자 실행 결과 필요]
  - 공격 샘플 수: [사용자 실행 결과 필요]
  - 총 고유 CAN ID 수: [사용자 실행 결과 필요]

### 데이터 전처리

원시 CAN 데이터를 HyDL-IDS 모델에 적합한 형태로 변환하기 위해 다음과 같은 전처리 과정을 수행하였습니다.

#### 1. CAN ID 전처리
- **방법**: 16진수 CAN ID를 정수로 인코딩 (0부터 N-1까지, N은 고유 ID 수)
- **목적**: 범주형 데이터인 CAN ID를 딥러닝 모델이 처리할 수 있는 수치형으로 변환
- **구현 세부 사항**:
  ```python
  # LabelEncoder를 사용하여 고유한 CAN ID를 0부터 N-1까지의 정수로 매핑
  label_encoder = LabelEncoder()
  encoded_can_ids = label_encoder.fit_transform(can_ids)
  ```

#### 2. DLC 전처리
- **방법**: log(값 + 1) 변환 후 0-1 범위로 스케일링 (Min-Max Scaling)
- **목적**: 데이터 분포를 정규화하고 모델 학습 안정성 향상
- **구현 세부 사항**:
  ```python
  # log(값 + 1) 변환
  log_dlc = np.log1p(dlc_values)
  
  # Min-Max 스케일링 (0-1 범위)
  scaler = MinMaxScaler()
  normalized_dlc = scaler.fit_transform(log_dlc.reshape(-1, 1)).flatten()
  ```

#### 3. DATA 필드 전처리
- **단계 1**: 각 행의 DLC 값에 따라 실제 데이터 바이트 수 결정
- **단계 2**: 16진수 데이터 바이트를 10진수 값(0-255)으로 변환
- **단계 3**: 존재하지 않는 바이트('M')는 256으로 변환
- **단계 4**: log(값 + 1) 변환 후 0-1 범위로 스케일링
- **목적**: 데이터 바이트를 정규화하고, 결측 데이터와 유효 데이터를 구분
- **구현 세부 사항**:
  ```python
  # DLC 값에 따라 처리
  for i in range(n_samples):
      dlc = dlc_values[i]
      
      for j in range(8):
          if j < dlc:
              # 16진수 데이터 바이트를 10진수로 변환
              try:
                  if data_bytes[i, j] != 'M':
                      decimal_data[i, j] = int(data_bytes[i, j], 16)
                  else:
                      decimal_data[i, j] = 256
              except:
                  decimal_data[i, j] = 256
          else:
              # 존재하지 않는 바이트는 256으로 처리
              decimal_data[i, j] = 256
  
  # log(값 + 1) 변환 및 스케일링
  log_data = np.log1p(decimal_data)
  normalized_data = scaler.fit_transform(log_data)
  ```

#### 4. Flag/Tag 전처리
- **방법**: 'R'(정상)을 0으로, 'T'(공격)를 1로 인코딩
- **목적**: 범주형 라벨을 이진 분류 모델의 타겟으로 변환
- **구현 세부 사항**:
  ```python
  # 'R'을 0으로, 'T'를 1로 변환
  encoded_flags = np.array([0 if flag == 'R' else 1 for flag in flags])
  ```

#### 5. 시퀀스 데이터 생성
- **방법**: 윈도우 슬라이딩 방식으로 연속된 CAN 메시지를 시퀀스로 그룹화
- **파라미터**:
  - 윈도우 크기: 10 (각 시퀀스에 포함될 메시지 수)
  - 스트라이드: 1 (연속 시퀀스 간의 간격)
- **목적**: 시간적 패턴을 학습할 수 있는 형태로 데이터 구성
- **구현 세부 사항**:
  ```python
  # 시퀀스 생성
  n_sequences = (n_samples - window_size) // stride + 1
  X = np.zeros((n_sequences, window_size, n_features))
  y = np.zeros(n_sequences)
  
  for i in range(n_sequences):
      start_idx = i * stride
      end_idx = start_idx + window_size
      
      X[i] = features[start_idx:end_idx]
      y[i] = labels[end_idx - 1]  # 시퀀스의 마지막 샘플 라벨 사용
  ```

#### 6. 결측값 처리
- **CAN ID (범주형)**: 최빈값으로 대체
- **DLC (수치형)**: 중앙값으로 대체
- **DATA 필드**: DLC 값과 연계하여 처리, 유효하지 않은 값은 'M'으로 대체
- **Flag/Tag (범주형)**: 결측값은 'R'(정상)으로 간주
- **목적**: 데이터 품질 보장 및 모델 학습 안정성 향상

#### 최종 입력 데이터 형태
- **X_sequences**: [시퀀스 수, 윈도우 크기, 특성 수]
  - 시퀀스 수: [사용자 실행 결과 필요]
  - 윈도우 크기: 10
  - 특성 수: 10 (CAN ID(1) + DLC(1) + DATA 바이트(8))
- **y_sequences**: [시퀀스 수] (각 시퀀스의 라벨, 0 또는 1)

### 학습 파라미터

HyDL-IDS 모델은 다음과 같은 학습 파라미터와 설정을 사용하여 학습되었습니다:

#### 모델 파라미터
- **첫 번째 컨볼루션 레이어**: 필터 32개, 커널 크기 3
- **두 번째 컨볼루션 레이어**: 필터 64개, 커널 크기 3
- **LSTM 레이어**: 128 유닛
- **Dense 레이어**: 128 유닛
- **Dropout 비율**: 0.2

#### 학습 설정
- **옵티마이저**: Adam
- **학습률**: 0.001
- **손실 함수**: binary_crossentropy
- **배치 크기**: 256
- **에포크 수**: 10
- **조기 종료 (EarlyStopping)**: 
  - monitor: 'val_accuracy'
  - min_delta: 0.01
  - patience: 3
  - restore_best_weights: True

#### 데이터 분할
- **학습 세트**: 67%
- **검증 세트**: 13%
- **테스트 세트**: 20%

### 평가 지표

모델의 성능을 평가하기 위해 다음과 같은 지표를 사용하였습니다:

1. **Accuracy (정확도)**: 전체 예측 중 올바른 예측의 비율
   - 수식: (TP + TN) / (TP + TN + FP + FN)

2. **Precision (정밀도)**: 공격으로 예측한 것 중 실제 공격의 비율
   - 수식: TP / (TP + FP)
   - 중요성: 오탐지(False Positive) 최소화를 평가

3. **Recall (재현율)**: 실제 공격 중 공격으로 올바르게 예측한 비율
   - 수식: TP / (TP + FN)
   - 중요성: 미탐지(False Negative) 최소화를 평가

4. **F1-score**: 정밀도와 재현율의 조화 평균
   - 수식: 2 * (Precision * Recall) / (Precision + Recall)
   - 중요성: 정밀도와 재현율 간의 균형을 평가

5. **False Positive Rate (FPR)**: 실제 정상 중 오탐지된 비율
   - 수식: FP / (FP + TN)
   - 중요성: 불필요한 경보 발생 정도를 평가

6. **False Negative Rate (FNR)**: 실제 공격 중 미탐지된 비율
   - 수식: FN / (FN + TP)
   - 중요성: 실제 공격 미탐지 정도를 평가

이러한 다양한 지표를 통해 모델의 전반적인 성능과 특정 상황(오탐지 최소화 또는 미탐지 최소화)에 대한 적합성을 종합적으로 평가할 수 있습니다.

## IV. 결과 및 분석

이 섹션에서는 HyDL-IDS 모델의 실험 결과를 제시하고 분석합니다. 학습 과정에서의 성능 변화와 테스트 세트에서의 최종 평가 결과를 상세히 살펴봅니다.

### 학습 성능

학습 과정 동안 모델의 손실 및 정확도 변화를 분석하여 학습 진행 상황과 모델의 안정성을 평가하였습니다.

#### 손실(Loss) 변화

[사용자 제공 손실 곡선 그래프 또는 표 삽입]

**분석**:
- **학습 손실**: [사용자 실행 결과에 따른 분석 필요]
- **검증 손실**: [사용자 실행 결과에 따른 분석 필요]
- **수렴 패턴**: [사용자 실행 결과에 따른 분석 필요]
- **과적합/과소적합 징후**: [사용자 실행 결과에 따른 분석 필요]
- **EarlyStopping 효과**: [사용자 실행 결과에 따른 분석 필요]

#### 정확도(Accuracy) 변화

[사용자 제공 정확도 곡선 그래프 또는 표 삽입]

**분석**:
- **학습 정확도**: [사용자 실행 결과에 따른 분석 필요]
- **검증 정확도**: [사용자 실행 결과에 따른 분석 필요]
- **수렴 속도**: [사용자 실행 결과에 따른 분석 필요]
- **최종 에포크에서의 성능**: [사용자 실행 결과에 따른 분석 필요]

#### 주요 학습 관찰사항
- **학습 시간**: [사용자 실행 결과 필요]
- **최적 에포크**: [사용자 실행 결과 필요]
- **수렴 특성**: [사용자 실행 결과에 따른 분석 필요]
- **하이퍼파라미터 영향**: [사용자 실행 결과에 따른 분석 필요]

### 테스트 세트 성능

테스트 세트에서의 성능 평가 결과를 통해 모델의 일반화 능력과 실제 환경에서의 효과성을 확인하였습니다.

#### 전체 평가 지표

| 평가 지표 | 값 |
|----------|-----|
| Accuracy | [사용자 실행 결과 필요] |
| Precision | [사용자 실행 결과 필요] |
| Recall | [사용자 실행 결과 필요] |
| F1-score | [사용자 실행 결과 필요] |
| FPR | [사용자 실행 결과 필요] |
| FNR | [사용자 실행 결과 필요] |

**분석**:
- **전반적 성능**: [사용자 실행 결과에 따른 분석 필요]
- **정밀도-재현율 균형**: [사용자 실행 결과에 따른 분석 필요]
- **오탐지와 미탐지 비율**: [사용자 실행 결과에 따른 분석 필요]
- **차량 네트워크 환경에의 적합성**: [사용자 실행 결과에 따른 분석 필요]

#### 혼동 행렬(Confusion Matrix)

[사용자 제공 혼동 행렬 그래프 또는 표 삽입]

| | 예측: 정상 | 예측: 공격 |
|----------|------------|------------|
| **실제: 정상** | TN: [사용자 실행 결과 필요] | FP: [사용자 실행 결과 필요] |
| **실제: 공격** | FN: [사용자 실행 결과 필요] | TP: [사용자 실행 결과 필요] |

**분석**:
- **True Negative (TN)**: [사용자 실행 결과에 따른 분석 필요]
- **False Positive (FP)**: [사용자 실행 결과에 따른 분석 필요]
- **False Negative (FN)**: [사용자 실행 결과에 따른 분석 필요]
- **True Positive (TP)**: [사용자 실행 결과에 따른 분석 필요]

#### ROC 곡선 및 AUC

[사용자 제공 ROC 곡선 그래프 삽입]

- **AUC 값**: [사용자 실행 결과 필요]
- **분석**: [사용자 실행 결과에 따른 분석 필요]

#### 정밀도-재현율 곡선

[사용자 제공 정밀도-재현율 곡선 그래프 삽입]

- **평균 정밀도(AP)**: [사용자 실행 결과 필요]
- **분석**: [사용자 실행 결과에 따른 분석 필요]

#### 공격 유형별 성능

다양한 공격 유형에 대한 모델의 탐지 성능을 비교 분석하였습니다.

| 공격 유형 | 정확도 | 정밀도 | 재현율 | F1-score |
|----------|--------|--------|--------|----------|
| DoS | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] |
| Fuzzy | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] |
| Spoofing Gear | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] |
| Spoofing RPM | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] | [사용자 실행 결과 필요] |

**분석**:
- **공격 유형 간 탐지 효율성 차이**: [사용자 실행 결과에 따른 분석 필요]
- **특정 공격 유형에 대한 모델의 강점/약점**: [사용자 실행 결과에 따른 분석 필요]
- **탐지하기 어려운 공격 유형과 그 이유**: [사용자 실행 결과에 따른 분석 필요]

### 각 지표의 의미 및 모델 성능 논의

실험 결과를 바탕으로 HyDL-IDS 모델의 전반적인 성능과 실제 차량 환경에서의 적용 가능성에 대해 논의합니다.

- **정확도와 신뢰성**: [사용자 실행 결과에 따른 분석 필요]
- **오탐지와 미탐지의 영향**: [사용자 실행 결과에 따른 분석 필요]
- **실시간 탐지 가능성**: [사용자 실행 결과에 따른 분석 필요]
- **자원 요구사항과 효율성**: [사용자 실행 결과에 따른 분석 필요]

## V. 논의

이 섹션에서는 HyDL-IDS 모델의 강점, 한계점, 그리고 향후 개선 방향에 대해 논의합니다.

### HyDL-IDS 모델의 강점

1. **하이브리드 아키텍처의 효과성**:
   - CNN과 LSTM의 결합으로 공간적 특징과 시간적 특징을 모두 추출함으로써 단일 방법론보다 뛰어난 탐지 성능을 보여주었습니다.
   - [사용자 실행 결과에 따른 구체적인 강점 분석 필요]

2. **다양한 공격 유형에 대한 탐지 능력**:
   - DoS, Fuzzy, Spoofing 등 여러 유형의 공격에 대해 일관된 탐지 성능을 보였습니다.
   - [사용자 실행 결과에 따른 구체적인 강점 분석 필요]

3. **시계열 데이터 활용**:
   - 개별 CAN 메시지가 아닌 시퀀스 단위로 분석함으로써 복잡한 공격 패턴도 포착할 수 있는 능력을 갖추었습니다.
   - [사용자 실행 결과에 따른 구체적인 강점 분석 필요]

4. **효율적인 특징 추출**:
   - 원본 CAN 데이터에 대한 효과적인 전처리와 특징 추출을 통해 모델의 학습 및 추론 효율성을 높였습니다.
   - [사용자 실행 결과에 따른 구체적인 강점 분석 필요]

### 관찰된 한계점

1. **특정 공격 유형에 대한 탐지 어려움**:
   - [사용자 실행 결과에 따른 한계점 분석 필요]
   - 가능한 원인과 개선 방향 제시

2. **모델 크기와 계산 요구사항**:
   - [사용자 실행 결과에 따른 한계점 분석 필요]
   - 차량 내 제한된 컴퓨팅 환경에서의 적용 가능성 논의

3. **실시간 탐지에 대한 고려사항**:
   - [사용자 실행 결과에 따른 한계점 분석 필요]
   - 실제 차량 환경에서의 지연 시간 및 처리 속도 관련 논의

4. **새로운 공격 유형에 대한 적응성**:
   - [사용자 실행 결과에 따른 한계점 분석 필요]
   - 알려지지 않은 공격에 대한 탐지 능력 논의

### 향후 개선 방향

1. **모델 아키텍처 개선**:
   - Attention 메커니즘 도입: 시퀀스 내 중요 특징에 가중치 부여
   - 자가 지도 학습(Self-supervised learning) 기법 적용: 레이블이 제한된 환경에서의 학습 개선
   - 트랜스포머(Transformer) 기반 모델 실험: 장거리 의존성 포착 능력 강화

2. **특징 공학 발전**:
   - 도메인 지식을 활용한 고급 특징 추출: CAN 프로토콜 특성 기반 특징 설계
   - 시간적 특징 강화: 메시지 간 시간 간격, 주기성 등의 메타 정보 활용
   - 자동 특징 선택 메커니즘 도입: 모델 효율성 및 성능 최적화

3. **실시간 처리 최적화**:
   - 모델 경량화: 프루닝(pruning), 양자화(quantization) 등의 기법 적용
   - 증분 학습(Incremental learning) 구현: 새로운 데이터로 모델을 지속적으로 업데이트
   - 하드웨어 가속 활용: 차량 환경에 맞는 최적화된 추론 엔진 개발

4. **강화된 보안 대응체계**:
   - 이상 탐지 이후의 자동 대응 메커니즘 연구: 공격 유형별 맞춤형 대응책 구현
   - 다중 모델 앙상블 접근법: 여러 탐지 모델의 결합으로 전체 시스템 강건성 향상
   - 공격 모니터링 및 로깅 체계 개발: 추후 분석 및 방어 전략 수립을 위한 데이터 수집

5. **광범위한 차량 환경 테스트**:
   - 다양한 차량 모델 및 제조사의 CAN 데이터에 대한 검증: 일반화 성능 평가
   - 실제 주행 환경에서의 필드 테스트: 현실 세계 성능 및 한계점 파악
   - 다양한 운행 조건에서의 성능 검증: 극한 상황에서의 안정성 평가

이러한 개선 방향을 통해 HyDL-IDS 모델은 더욱 견고하고 실용적인 차량 내부 네트워크 침입 탐지 시스템으로 발전할 수 있을 것입니다.

## VI. 결론

본 연구에서는 차량 내부 네트워크 침입 탐지를 위한 하이브리드 딥러닝 기반 모델인 HyDL-IDS를 개발하고 평가하였습니다. 차량 CAN 버스에서 발생하는 다양한 유형의 사이버 공격을 효과적으로 탐지하기 위해 CNN과 LSTM을 결합한 하이브리드 아키텍처를 설계하였으며, Car-Hacking 데이터셋(HCRL, 고려대학교)을 사용하여 모델의 성능을 실험적으로 검증하였습니다.

### 주요 연구 결과 요약

1. **하이브리드 아키텍처의 효과성**:
   - CNN을 통한 공간적 특징 추출과 LSTM을 통한 시간적 특징 추출의 결합은 [사용자 실행 결과]의 정확도를 달성하였으며, 이는 단일 방법론에 비해 [사용자 분석에 따른 비교] 향상된 성능입니다.
   - 시퀀스 기반 접근 방식은 CAN 메시지의 시간적 패턴을 효과적으로 포착하여 복잡한 공격 패턴도 탐지할 수 있음을 확인하였습니다.

2. **공격 유형별 탐지 성능**:
   - DoS 공격: [사용자 실행 결과]의 F1 점수로 가장 높은 탐지율을 보였습니다.
   - Fuzzy 공격: [사용자 실행 결과]의 F1 점수를 기록했습니다.
   - Spoofing 공격(Gear/RPM): [사용자 실행 결과]의 평균 F1 점수로 탐지되었습니다.
   - 이러한 결과는 [사용자 분석에 따른 결론]를 시사합니다.

3. **오탐지 및 미탐지 분석**:
   - FPR(False Positive Rate): [사용자 실행 결과]로, 이는 [사용자 분석에 따른 의미] 수준입니다.
   - FNR(False Negative Rate): [사용자 실행 결과]로, 이는 [사용자 분석에 따른 의미] 수준입니다.
   - 이러한 균형은 실제 차량 환경에서 [사용자 분석에 따른 함의]를 의미합니다.

4. **모델 효율성**:
   - 약 12만 개의 파라미터로 구성된 효율적인 모델 구조를 통해 차량 내 제한된 컴퓨팅 환경에서도 적용 가능성을 확인하였습니다.
   - 추론 시간은 [사용자 실행 결과]로 실시간 탐지에 [사용자 분석에 따른 적합성] 수준입니다.

### 프로젝트 목표 달성 평가

본 연구의 초기 목표였던 "차량 내부 네트워크 침입 탐지를 위한 HyDL-IDS 모델 구현 및 분석"은 다음과 같이 달성되었습니다:

1. **모델 구현**: CNN과 LSTM을 결합한 하이브리드 딥러닝 아키텍처를 성공적으로 구현하고, 효과적인 전처리 파이프라인을 개발하였습니다.

2. **성능 검증**: Car-Hacking 데이터셋을 사용하여 모델을 학습하고 평가한 결과, [사용자 실행 결과]의 높은 정확도와 F1 점수를 달성하였습니다.

3. **분석 완료**: 다양한 성능 지표와 시각화를 통해 모델의 강점, 한계점, 그리고 개선 방향을 포괄적으로 분석하였습니다.

### 연구의 의의 및 향후 전망

본 연구는 차량 내부 네트워크 보안의 중요성이 증가하는 가운데, 효과적인 침입 탐지 솔루션을 제시하였다는 점에서 의의가 있습니다. 특히, 하이브리드 딥러닝 접근 방식을 통해 CAN 트래픽에서 발생하는 다양한 유형의 공격을 포괄적으로 탐지할 수 있는 가능성을 보여주었습니다.

향후 연구에서는 모델의 일반화 능력 향상, 경량화, 실시간 처리 최적화, 그리고 다양한 차량 환경에서의 검증을 통해 실제 적용 가능한 솔루션으로 발전시킬 필요가 있습니다. 또한, 새로운 공격 유형에 대한 적응성을 높이기 위한 지속적인 학습 방법론과 이상 탐지 이후의 자동 대응 메커니즘 연구도 중요한 과제로 남아있습니다.

결론적으로, HyDL-IDS는 차량 내부 네트워크 보안 강화를 위한 유망한 접근 방식이며, 본 연구의 결과는 향후 더욱 안전한 커넥티드 카 및 자율주행 차량 개발에 기여할 수 있을 것으로 기대됩니다.

## VII. 참고문헌

1. [사용자가 참고한 관련 논문 및 자료 기재]

2. Car-Hacking 데이터셋 (HCRL, 고려대학교)
   [사용자 제공 참조 정보 필요]

3. [추가 참고문헌]